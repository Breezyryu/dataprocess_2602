# í•¨ìˆ˜ ìˆ˜ì • ì™„ë£Œ - ìƒˆë¡œìš´ ë°ì´í„° êµ¬ì¡°

## ğŸ“‹ ìˆ˜ì • ê°œìš”

ì‚¬ìš©ì ìš”ì²­ì— ë”°ë¼ ë°ì´í„° êµ¬ì¡°ë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤:

1. **`cycle_list_processor.process_all_channels(data)`** - ì›ë˜ ë²„ì „ìœ¼ë¡œ ë³µì› (ì›ë³¸ ìˆ˜ì • í—ˆìš©)
2. **`channel_categorizer.categorize_all_channels(data)`** - ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì´í´ì„ `data` êµ¬ì¡°ì— ì§ì ‘ ì €ì¥

## ğŸ¯ ìƒˆë¡œìš´ ë°ì´í„° êµ¬ì¡°

```python
data['channels'][channel_key]['cycle_list'] = {
    'Unknown': [cycle_df, cycle_df, ...],
    'RPT': [cycle_df, cycle_df, ...],
    'SOC_Definition': [cycle_df, cycle_df, ...],
    'Resistance_Measurement': [cycle_df, cycle_df, ...],
    'Accelerated_Aging': [cycle_df, cycle_df, ...]
}
```

## ğŸ”§ ìˆ˜ì • ë‚´ìš©

### 1. `cycle_list_processor.py` - ì›ë˜ ë²„ì „ìœ¼ë¡œ ë³µì›

**ë³€ê²½ì‚¬í•­:**
- `import copy` ì œê±°
- `data = copy.deepcopy(data)` ë¼ì¸ ì œê±°
- ì›ë³¸ ë°ì´í„°ë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ë„ë¡ ë³µì›

**íš¨ê³¼:**
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì 
- âœ… ì²˜ë¦¬ ì†ë„ í–¥ìƒ
- âœ… ì›ë³¸ ë°ì´í„° ì§ì ‘ ìˆ˜ì •

---

### 2. `channel_categorizer.py` - ì™„ì „íˆ ìƒˆë¡œìš´ êµ¬ì¡°

**ë³€ê²½ì‚¬í•­:**

```python
def categorize_all_channels(data):
    """
    Returns:
    --------
    dict : ì…ë ¥ëœ data ê°ì²´ (ê° ì±„ë„ì— cycle_list ë”•ì…”ë„ˆë¦¬ê°€ ì¶”ê°€ë¨)
        data['channels'][channel_key]['cycle_list'] = {
            'Unknown': [cycle_df, ...],
            'RPT': [cycle_df, ...],
            ...
        }
    """
    
    for channel_key, channel_data in data['channels'].items():
        cycle_list = channel_data['profile']
        
        # ì¹´í…Œê³ ë¦¬í™” ìˆ˜í–‰
        categories = cycle_categorizer.categorize_cycles(cycle_list)
        
        # ì¹´í…Œê³ ë¦¬ë³„ë¡œ cycle ë¶„ë¥˜í•˜ì—¬ ì €ì¥
        categorized_cycles = {}
        for category, indices in categories.items():
            categorized_cycles[category] = [cycle_list[i] for i in indices]
        
        # data êµ¬ì¡°ì— ì§ì ‘ ì €ì¥
        channel_data['cycle_list'] = categorized_cycles
    
    return data
```

**íš¨ê³¼:**
- âœ… `data` êµ¬ì¡°ì— ì§ì ‘ ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì´í´ ì €ì¥
- âœ… ë³„ë„ì˜ `results` ë”•ì…”ë„ˆë¦¬ ë¶ˆí•„ìš”
- âœ… ì§ê´€ì ì¸ ì ‘ê·¼ ë°©ì‹

---

## ğŸ“Š ì‚¬ìš© ë°©ë²•

### ê¸°ë³¸ ì‚¬ìš©ë²•

```python
import data_combiner
import cycle_list_processor
import channel_categorizer

# ë°ì´í„° ë¡œë“œ ë° ì²˜ë¦¬
data = data_combiner.process_and_combine(paths)
data = cycle_list_processor.process_all_channels(data)
data = channel_categorizer.categorize_all_channels(data)

# ì±„ë„ í‚¤ ê°€ì ¸ì˜¤ê¸°
channel_key = list(data['channels'].keys())[0]
```

### ì¹´í…Œê³ ë¦¬ë³„ ì‚¬ì´í´ ì ‘ê·¼

#### ë°©ë²• 1: ì§ì ‘ ì ‘ê·¼ (ê¶Œì¥)

```python
# RPT ì‚¬ì´í´ë§Œ ê°€ì ¸ì˜¤ê¸°
rpt_cycles = data['channels'][channel_key]['cycle_list']['RPT']
print(f"RPT ì‚¬ì´í´ ìˆ˜: {len(rpt_cycles)}")

# Accelerated_Aging ì‚¬ì´í´ë§Œ ê°€ì ¸ì˜¤ê¸°
aging_cycles = data['channels'][channel_key]['cycle_list']['Accelerated_Aging']
print(f"Aging ì‚¬ì´í´ ìˆ˜: {len(aging_cycles)}")

# íŠ¹ì • ì‚¬ì´í´ ê°€ì ¸ì˜¤ê¸°
first_rpt = data['channels'][channel_key]['cycle_list']['RPT'][0]
print(f"ì²« ë²ˆì§¸ RPT ì‚¬ì´í´ shape: {first_rpt.shape}")
```

#### ë°©ë²• 2: í—¬í¼ í•¨ìˆ˜ ì‚¬ìš©

```python
# get_category_cycles í•¨ìˆ˜ ì‚¬ìš©
rpt_cycles = channel_categorizer.get_category_cycles(
    data, 
    channel_index=0, 
    category='RPT'
)
```

#### ë°©ë²• 3: ëª¨ë“  ì¹´í…Œê³ ë¦¬ ìˆœíšŒ

```python
# ëª¨ë“  ì¹´í…Œê³ ë¦¬ ìˆœíšŒ
for category, cycles in data['channels'][channel_key]['cycle_list'].items():
    print(f"{category}: {len(cycles)}ê°œ ì‚¬ì´í´")
    if cycles:
        print(f"  ì²« ë²ˆì§¸ ì‚¬ì´í´ shape: {cycles[0].shape}")
```

### ë‹¤ì¤‘ ì±„ë„ ì²˜ë¦¬

```python
# ëª¨ë“  ì±„ë„ì˜ RPT ì‚¬ì´í´ ì²˜ë¦¬
for channel_key, channel_data in data['channels'].items():
    if 'cycle_list' in channel_data:
        rpt_cycles = channel_data['cycle_list']['RPT']
        print(f"{channel_key}: {len(rpt_cycles)}ê°œ RPT ì‚¬ì´í´")
```

---

## ğŸ”‘ ì£¼ìš” ì¥ì 

### 1. ì§ê´€ì ì¸ ì ‘ê·¼
```python
# ì´ì „ ë°©ì‹ (ë³µì¡)
results = channel_categorizer.categorize_all_channels(data)
rpt_cycles = results[channel_key]['cycle_list']  # category ë¼ë²¨ì´ ì¶”ê°€ëœ ì „ì²´ ë¦¬ìŠ¤íŠ¸
# ì—¬ì „íˆ í•„í„°ë§ í•„ìš”...

# ìƒˆë¡œìš´ ë°©ì‹ (ê°„ë‹¨)
data = channel_categorizer.categorize_all_channels(data)
rpt_cycles = data['channels'][channel_key]['cycle_list']['RPT']  # ë°”ë¡œ ì ‘ê·¼!
```

### 2. ë°ì´í„° ì¼ê´€ì„±
- ëª¨ë“  ë°ì´í„°ê°€ í•˜ë‚˜ì˜ `data` ê°ì²´ì— í†µí•©
- ë³„ë„ì˜ `results` ë”•ì…”ë„ˆë¦¬ ê´€ë¦¬ ë¶ˆí•„ìš”

### 3. ìœ ì—°í•œ ì ‘ê·¼
- ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥
- í•„í„°ë§ ì—†ì´ ë°”ë¡œ ì›í•˜ëŠ” ì‚¬ì´í´ ê·¸ë£¹ ì‚¬ìš©

---

## ğŸ“ í—¬í¼ í•¨ìˆ˜

### `get_category_cycles(data, channel_index=0, category='RPT')`

íŠ¹ì • ì±„ë„ì˜ íŠ¹ì • ì¹´í…Œê³ ë¦¬ ì‚¬ì´í´ ê°€ì ¸ì˜¤ê¸°

**Parameters:**
- `data`: categorize_all_channels()ì˜ ì¶œë ¥
- `channel_index`: ì±„ë„ ì¸ë±ìŠ¤ (ê¸°ë³¸ê°’: 0)
- `category`: ì¹´í…Œê³ ë¦¬ ì´ë¦„

**Returns:**
- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ì‚¬ì´í´ DataFrame ë¦¬ìŠ¤íŠ¸

**ì‚¬ìš© ì˜ˆì‹œ:**
```python
# RPT ì‚¬ì´í´ ê°€ì ¸ì˜¤ê¸°
rpt_cycles = channel_categorizer.get_category_cycles(data, channel_index=0, category='RPT')

# SOC_Definition ì‚¬ì´í´ ê°€ì ¸ì˜¤ê¸°
soc_cycles = channel_categorizer.get_category_cycles(data, channel_index=0, category='SOC_Definition')
```

### `print_channel_categorization(data, channel_index=0)`

íŠ¹ì • ì±„ë„ì˜ ì¹´í…Œê³ ë¦¬í™” ê²°ê³¼ ìƒì„¸ ì¶œë ¥

**ì‚¬ìš© ì˜ˆì‹œ:**
```python
channel_categorizer.print_channel_categorization(data, channel_index=0)
```

---

## âœ… ì™„ë£Œëœ ì‘ì—…

1. âœ… `cycle_list_processor.py` ì›ë˜ ë²„ì „ìœ¼ë¡œ ë³µì›
2. âœ… `channel_categorizer.py` ì™„ì „íˆ ë¦¬íŒ©í† ë§
3. âœ… ìƒˆë¡œìš´ ë°ì´í„° êµ¬ì¡° êµ¬í˜„
4. âœ… í—¬í¼ í•¨ìˆ˜ ì—…ë°ì´íŠ¸
5. âœ… ì‚¬ìš© ì˜ˆì‹œ ì‘ì„± ([`example_new_structure.py`](file:///c:/Users/Ryu/Python_project/data/dataprocess_2601/example_new_structure.py))

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

ë…¸íŠ¸ë¶ì—ì„œ ì‚¬ìš©í•˜ê¸°:

```python
import importlib
importlib.reload(cycle_list_processor)
importlib.reload(channel_categorizer)

# ë°ì´í„° ì²˜ë¦¬
data = data_combiner.process_and_combine(paths)
data = cycle_list_processor.process_all_channels(data)
data = channel_categorizer.categorize_all_channels(data)

# ì¹´í…Œê³ ë¦¬ë³„ ì ‘ê·¼
channel_key = list(data['channels'].keys())[0]
rpt_cycles = data['channels'][channel_key]['cycle_list']['RPT']
```
